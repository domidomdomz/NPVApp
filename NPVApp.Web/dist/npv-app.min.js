var vueSvc={service:function(e,t){this[e]=new t}};function svcBase(e){this.controller=e}function nullReplacer(e,t){return null===t?void 0:t}function getResponseErrors(e){if(e.responseJSON&&e.responseJSON.Errors)return e.responseJSON.Errors;if(e.responseJSON){var t=[{Key:"",Message:e.responseJSON.ExceptionMessage||e.responseJSON.Message}];return t}return t=[{Key:"",Message:e.responseText||e.statusText}]}$.authGet=function(e){return $.ajax({type:"GET",contentType:"application/json; charset=utf-8",url:e,error:function(e){console.log(e)}})},$.authPost=function(e,t){var n=JSON.stringify(t,nullReplacer);return $.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:e,data:n,error:function(e){console.log(e)}})},$.authPut=function(e,t){var n=JSON.stringify(t,nullReplacer);return $.ajax({type:"PUT",contentType:"application/json; charset=utf-8",url:e,data:n,error:function(e){console.log(e)}})},$.authDelete=function(e){return $.ajax({type:"DELETE",contentType:"application/json; charset=utf-8",url:e,error:function(e){console.log(e)}})},vueSvc.service("calculate",function(){svcBase.call(this,"calculate"),this.doCalculateNPV=function(e){return $.authPost("/api/npv/calculate",e)}}),vueSvc.service("dashboard",function(){svcBase.call(this,"dashboard"),this.getRequests=function(){return $.authGet("/api/npv/requests")},this.getRequestById=function(e){return $.authGet("/api/npv/requests?id="+e)},this.newCalculateNPVRequest=function(){return{Id:0,InitialInvestment:0,LowerBoundDiscountRate:.01,UpperBoundDiscountRate:.01,DiscountRateIncrement:.01,CashFlows:[{CashFlowValue:0}]}},this.newCashFlow=function(){return{CashFlowValue:0}}}),vueSvc.service("results",function(){svcBase.call(this,"results"),this.getResults=function(e){return $.authGet("/api/npv/results?id="+e)}}),vueSvc.service("templates",function(){this.load=function(e){return $.get("/dist/components/"+e+"?v="+BuildDate)}});var npvFormComponent=Vue.component("npv-form",function(t,e){var o;function n(){return{id:null,calculateNPVRequest:vueSvc.dashboard.newCalculateNPVRequest(),calculateNPVResults:[],saving:!1,errors:[]}}function i(){(o=this).id=o.$route.params.id||0,o.calculateNPVRequest.Id=o.id,o.id&&(s(),vueSvc.results.getResults(o.id).done(function(e){o.calculateNPVResults=e}).fail(function(e){o.errors=getResponseErrors(e),showGenericError(o.errors),o.saving=!1}))}function r(){}function u(e){o.errors=[],e=e||-1,o.calculateNPVRequest.CashFlows.push(vueSvc.dashboard.newCashFlow())}function a(e){o.errors=[],o.calculateNPVRequest.CashFlows.splice(e,1)}function c(e){return getErrorByKey(o.errors,e)}function l(){o.saving=!0;var e=_.cloneDeep(o.calculateNPVRequest.CashFlows),t=_.map(e,function(e){if(null!=e.CashFlowValue)return e.CashFlowValue}),n={InitialInvestment:o.calculateNPVRequest.InitialInvestment,LowerBoundDiscountRate:o.calculateNPVRequest.LowerBoundDiscountRate,UpperBoundDiscountRate:o.calculateNPVRequest.UpperBoundDiscountRate,DiscountRateIncrement:o.calculateNPVRequest.DiscountRateIncrement,CashFlows:t};vueSvc.calculate.doCalculateNPV(n).done(function(e){o.id=e,vueInfo("NPV successfully computed."),vueTo(o,"/calculate/result/"+e),o.saving=!1}).fail(function(e){o.errors=getResponseErrors(e),showGenericError(o.errors),o.saving=!1})}function s(){vueSvc.dashboard.getRequestById(o.id).done(function(e){o.calculateNPVRequest=e}).fail(function(e){o.errors=getResponseErrors(e),showGenericError(o.errors),o.saving=!1})}vueSvc.templates.load("calculate/npvForm.html").done(function(e){t({name:"npv-form",data:n,template:e,methods:{addCashFlow:u,getError:c,removeCashFlow:a,calculateNPV:l,loadCalculateRequest:s},created:i,mounted:r})})}),dashboardComponent=Vue.component("dashboard",function(t,e){var n;function o(){return{calculateNPVRequests:[],errors:[],loading:!1}}function i(){n=this,u()}function r(){}function u(){n.loading=!0,vueSvc.dashboard.getRequests().done(function(e){n.loading=!1,n.calculateNPVRequests=e})}function a(e){vueTo(n,"/calculate/result/"+e)}function c(){vueTo(n,"/calculate")}vueSvc.templates.load("dashboard/dashboard.html").done(function(e){t({name:"dashboard",data:o,template:e,methods:{loadCalculateRequests:u,viewCalculateRequest:a,goToCalculate:c},created:i,mounted:r})})}),breadcrumbComponent=Vue.component("breadcrumb",function(t,e){function n(){return{}}var o={text1:{type:String},route1:{type:String},text2:{type:String},route2:{type:String},text3:{type:String},route3:{type:String},text4:{type:String},route4:{type:String},text5:{type:String},route5:{type:String}};function i(){}function r(){}vueSvc.templates.load("shared/breadcrumb.html").done(function(e){t({name:"breadcrumb",data:n,props:o,template:e,methods:{},created:i,mounted:r})})}),BuildDate='2019.0622.1156';(new Date).getTime();function vueTo(e,t){e.$router.replace(t)}function vueToNewTab(e,t){var n=e.$router.resolve({path:t});window.open(n.href,"_blank")}function vueInfo(e){globalNotify(e=formatMessage(e),"alert alert-success")}function vueError(e){globalNotify(e=formatMessage(e),"alert alert-danger")}function vueWarn(e){globalNotify(e=formatMessage(e),"alert alert-warning")}function formatMessage(e){return e.replace(/<br>/g,"\n")}function globalNotify(e,t){$.notify.addStyle("dataNotifyText",{html:"<div><span data-notify-text class='font-12'/></div>"}),$.notify(e,{globalPosition:"top center",className:t,position:"top",style:"dataNotifyText"})}function showGenericError(e){vueError(getErrorByKey(e,""))}function getErrorByKey(e,t){var n=_.filter(e,{Key:t});return _.map(n,"Message").join(", ")}function isInputPositiveDecimal(e){return 48<=e.charCode&&e.charCode<=57||46==e.charCode}function applyMaxlength(e){e.value.length>e.maxLength&&(e.value=e.value.slice(0,e.maxLength))}var routes=[{path:"/",redirect:function(e){return"/dashboard"}},{path:"/dashboard",component:dashboardComponent,meta:{title:"Dashboard"}},{path:"*",component:dashboardComponent},{path:"/calculate",component:npvFormComponent,meta:{title:"Calculate NPV"}},{path:"/calculate/result/:id",component:npvFormComponent,meta:{title:"NPV Result"}}],router=new VueRouter({mode:"history",routes:routes});Vue.directive("focus",{inserted:function(e){e.focus()}}),Vue.directive("hand",function(e){e.style.cursor="pointer"}),Vue.directive("width",function(e,t){e.style.width=t.value+"px"}),Vue.directive("width-inherit",function(e){e.style.width="inherit"}),Vue.directive("width-pct",function(e,t){e.style.width=t.value+"%"}),Vue.directive("height",function(e,t){e.style.height=t.value+"px"}),Vue.directive("height-inherit",function(e){e.style.height="inherit"}),Vue.directive("height-pct",function(e,t){e.style.height=t.value+"%"}),Vue.directive("min-height",function(e,t){e.style.minHeight=t.value+"px"}),Vue.directive("max-height",function(e,t){e.style.maxHeight=t.value+"px"}),Vue.directive("max-height-pct",function(e,t){e.style.maxHeight=t.value+"%"}),Vue.directive("min-width",function(e,t){e.style.minWidth=t.value+"px"}),Vue.directive("max-width",function(e,t){e.style.maxWidth=t.value+"px"}),Vue.directive("max-width-pct",function(e,t){e.style.maxWidth=t.value+"%"}),Vue.directive("pad",function(e,t){e.style.padding=t.value+"px"}),Vue.directive("pad-top",function(e,t){e.style.paddingTop=t.value+"px"}),Vue.directive("pad-bottom",function(e,t){e.style.paddingBottom=t.value+"px"}),Vue.directive("pad-left",function(e,t){e.style.paddingLeft=t.value+"px"}),Vue.directive("pad-right",function(e,t){e.style.paddingRight=t.value+"px"}),Vue.directive("font-pt",function(e,t){e.style.fontSize=t.value+"pt"}),Vue.directive("font-pct",function(e,t){e.style.fontSize=t.value+"%"}),Vue.directive("font-wt",function(e,t){e.style.fontWeight=t.value}),Vue.directive("bold",function(e,t){e.style.fontWeight="bold"}),Vue.directive("line-through",function(e){e.style.textDecoration="line-through"}),Vue.directive("underline",function(e){e.style.textDecoration="underline"}),Vue.directive("italic",function(e){e.style.fontStyle="italic"}),Vue.directive("pre-wrap",function(e){e.style.whiteSpace="pre-wrap"}),Vue.directive("no-wrap",function(e){e.style.whiteSpace="nowrap"}),Vue.directive("normal-wrap",function(e){e.style.whiteSpace="normal"}),Vue.directive("color",function(e,t){e.style.color=t.value}),Vue.directive("bg-color",function(e,t){e.style.backgroundColor=t.value}),Vue.directive("center",function(e){e.style.textAlign="center"}),Vue.directive("left",function(e){e.style.textAlign="left"}),Vue.directive("right",function(e){e.style.textAlign="right"}),Vue.directive("top",function(e){e.style.verticalAlign="top"}),Vue.directive("middle",function(e){e.style.verticalAlign="middle"}),Vue.directive("bottom",function(e){e.style.verticalAlign="bottom"}),Vue.filter("money",function(e,t){return parseFloat(e,10).toFixed(t).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}),Vue.filter("percentage",function(e,t){return e||(e=0),t||(t=0),e*=100,Math.round(e*Math.pow(10,t))/Math.pow(10,t)+"%"}),Vue.filter("shortDateTimeWithSeconds",function(e){if(e)return moment(String(e)).format("DD/MMM/YYYY hh:mm:ss a")});var app=new Vue({el:"#app",router:router});